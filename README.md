# Text-classification
训练一个分类器（KNN、 SVM），对文本数据进行分类，类别可包括体育,财经,房产,家居,教育等十个类别。

文本分类的一般流程可以分为五步：
(1)对文本进行预处理，包括分词操作和停用词去除等；
(2)特征提取与特征选择，选择文本特征提取方法，并对特征进行选择，约减特征，尽量降低维度，减少计算量；
(3)文本表示，选择合适的方法表示选择的特征，作为分类的依据；
(4)分类器构建，选择合适的分类算法训练得到对应文本分类器；
结果评估，选择合适的评估指标，对分类结果进行评测

#实验内容
1.构建数据集
2.数据预处理（分词、去除停用词）
3.生成数据集的特征矩阵
4.使用朴素贝叶斯模型进行处理
5.使用 SVM 模型进行处理

本次实验使用到的数据集为实验预先提供的新闻训练集，新闻测试集，以及停用词。
训练集和测试集中包括共 10 个种类的新闻，但所有的新闻都在一个文档里，也没有分类的预先标识，因此我们实验的第一步为将数据集拆分为合适的文档形式。查看训练集和数据集内容，发现共有十个新闻分类，分别是'财经', '房产', '家居', '教育', '科技', '时尚', '时政', '体育', '游戏', '娱乐'。
split.py将总的数据集分为一个个文档，存在cnews-test、cnews-train文件夹下

text2term.py将数据集进行预处理，并将处理后的文档以 pkl 的格式存于新的目录下。
关于使用 pkl 格式文件的说明：
Pickling 可以将 python 对象保存为硬盘驱动器上的二进制文件。注意这个文件是带有对象的具体类型的，即在 load 一个 pkl 文件时，得到的内容直接就是一个对象，而没有使用 write 写入和 read 读出文件时必须是字符串的限制。
对于需要在数据中保持一定程度持久性的应用程序， Pickling 非常有用。 程序的状态数据可以保存到磁盘，因此可以稍后继续处理它。它还可用于通过传输控制协议（TCP）或套接字连接（Socket）发送数据，或将 python 对象存储在数据库中。当在使用机器学习算法时， Pickle 也非常有用，可以将它们保存在以后能够进行新的预测，而无需重新编写所有内容或重新训练模型。

生成数据集的特征矩阵
借助scikit-learn提供的CountVectorizer类完成向量化，得到训练集和测试集两个文本的特征矩阵，矩阵类型为稀疏矩阵。
首先选取测试集中每个类别下的 4800 个文档（本来每个类别下文档应该是 5000 个，但前面筛选之后部分文档被筛除，因此选择 4800 作为参数），获取其字符串和类别，这里以数字代表类别。

根据读取到的数据字符串和类别，分别生成训练集和测试集的特征矩阵，这里选取参数 min_df 的值为 0.001,作用为去除文档中文档频率小于0.1%的特征，这些特征我们认为出现的频率实在太低同时也不可能为某类文档的局部特征，以此完成降维。

使用朴素贝叶斯模型进行处理
统计每个文档的分类结果和分类情况，计算准确率，召回率和 F1 值，并打印分类错误的文档名。统计对应代码如图 15，内容包括每类文档被分类的结果矩阵，和每类文档分类的精确率，召回率和 F1 值，最终的平均准确率为 94.63%

使用 SVM 模型进行处理
训练 SVM 分类器
使用训练集个数据集生成的特征向量，构造 SVM 分类器；
借助 TfidfTransformer 使用 TF-IDF 对词频进行加权；
选用线性核 LinearSVC；
使用 gridSearchCV （网格搜索）自动计算出最优的参数和结果， cv = 5 表示使用五折交叉验证， n_jobs=3 表示并行数为 3；
得到最优参数后保存分类器到指定路径


两种模型的分类结果对比
(1)模型训练时长
朴素贝叶斯分类模型：0.772s
SVM 分类模型：3215s
(2)训练集分类耗时
朴素贝叶斯分类模型：6.9266s
SVM 分类模型：0.1577s
(3)模型分类结果
朴素贝叶斯分类模型：
平均准确率：94.65% 平均召回率：94.63% 平均 F1 值：94.58%
SVM 分类模型：
平均准确率：97%    平均召回率：97%    平均 F1 值：97%
